<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo Manejador de Errores JavaScript - PAQUETEX v4.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        .demo-section {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .demo-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1rem;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.5rem;
        }

        .demo-description {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .demo-button {
            background: #2563eb;
            color: white;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            margin: 0.25rem;
        }

        .demo-button:hover {
            background: #1d4ed8;
        }

        .demo-button-danger {
            background: #dc2626;
        }

        .demo-button-danger:hover {
            background: #b91c1c;
        }

        .demo-button-warning {
            background: #d97706;
        }

        .demo-button-warning:hover {
            background: #b45309;
        }

        .demo-button-success {
            background: #059669;
        }

        .demo-button-success:hover {
            background: #047857;
        }

        .demo-button-info {
            background: #7c3aed;
        }

        .demo-button-info:hover {
            background: #6d28d9;
        }

        .code-block {
            background: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            overflow-x: auto;
            margin: 1rem 0;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen py-8">
    <!-- Manejador de Errores JavaScript -->
    {% include 'components/javascript_error_handler_simple.html' %}

    <div class="container mx-auto px-4 max-w-6xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-4">
                üö® Demo Manejador de Errores JavaScript
            </h1>
            <p class="text-lg text-gray-600">
                PAQUETEX v4.0 - Captura y Muestra Errores de JavaScript
            </p>
        </div>

        <!-- Secci√≥n 1: Errores Autom√°ticos -->
        <div class="demo-section">
            <h2 class="demo-title">1. Errores Autom√°ticos Capturados</h2>
            <p class="demo-description">
                El sistema captura autom√°ticamente errores de JavaScript, promesas rechazadas y errores de recursos.
            </p>
            
            <div class="space-y-4">
                <button onclick="probarManejadorErrores()" class="demo-button-success">
                    Probar Manejador (Funci√≥n Global)
                </button>
                
                <button onclick="generarErrorJS()" class="demo-button-danger">
                    Generar Error de JavaScript
                </button>
                
                <button onclick="generarPromesaRechazada()" class="demo-button-warning">
                    Generar Promesa Rechazada
                </button>
                
                <button onclick="generarErrorRecurso()" class="demo-button-info">
                    Generar Error de Recurso
                </button>
            </div>
        </div>

        <!-- Secci√≥n 2: Errores Personalizados -->
        <div class="demo-section">
            <h2 class="demo-title">2. Errores Personalizados</h2>
            <p class="demo-description">
                Puedes mostrar errores personalizados usando las funciones globales disponibles.
            </p>
            
            <div class="space-y-4">
                <button onclick="mostrarErrorPersonalizado()" class="demo-button-danger">
                    Mostrar Error Personalizado
                </button>
                
                <button onclick="mostrarAdvertenciaPersonalizada()" class="demo-button-warning">
                    Mostrar Advertencia Personalizada
                </button>
                
                <button onclick="mostrarInformacionPersonalizada()" class="demo-button-info">
                    Mostrar Informaci√≥n Personalizada
                </button>
                
                <button onclick="mostrarExitoPersonalizado()" class="demo-button-success">
                    Mostrar √âxito Personalizado
                </button>
            </div>
        </div>

        <!-- Secci√≥n 3: Errores de Validaci√≥n -->
        <div class="demo-section">
            <h2 class="demo-title">3. Errores de Validaci√≥n</h2>
            <p class="demo-description">
                Ejemplo de c√≥mo usar el manejador de errores en formularios de validaci√≥n.
            </p>
            
            <div x-data="formularioValidacion()" class="max-w-md mx-auto bg-white p-6 rounded-lg shadow">
                <form @submit.prevent="validarFormulario()">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            N√∫mero de Gu√≠a
                        </label>
                        <input 
                            type="text" 
                            x-model="numeroGuia"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="Ingrese el n√∫mero de gu√≠a"
                        >
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Email del Cliente
                        </label>
                        <input 
                            type="email" 
                            x-model="emailCliente"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="Ingrese el email del cliente"
                        >
                    </div>
                    
                    <button type="submit" 
                            class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700">
                        Validar Formulario
                    </button>
                </form>
            </div>
        </div>

        <!-- Secci√≥n 4: C√≥digo de Implementaci√≥n -->
        <div class="demo-section">
            <h2 class="demo-title">4. C√≥digo de Implementaci√≥n</h2>
            <p class="demo-description">
                C√≥mo implementar el manejador de errores en tus p√°ginas.
            </p>
            
            <div class="space-y-4">
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-2">1. Incluir el Componente</h3>
                    <div class="code-block">
&lt;!-- Incluir en tu template --&gt;
{% include 'components/javascript_error_handler.html' %}
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-2">2. Funciones Disponibles</h3>
                    <div class="code-block">
// Mostrar error personalizado
window.mostrarErrorJS('T√≠tulo', 'Mensaje', 'error', 'Detalles opcionales');

// Mostrar error de validaci√≥n
window.mostrarErrorValidacion('El campo es requerido');

// Mostrar advertencia
window.mostrarAdvertencia('Esta operaci√≥n es irreversible');

// Mostrar informaci√≥n
window.mostrarInformacion('El sistema se reiniciar√° en 5 minutos');

// Mostrar √©xito
window.mostrarExito('Operaci√≥n completada exitosamente');
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-2">3. Captura Autom√°tica</h3>
                    <div class="code-block">
// El sistema captura autom√°ticamente:
// - Errores de JavaScript (window.onerror)
// - Promesas rechazadas (unhandledrejection)
// - Errores de recursos (im√°genes, scripts, etc.)
// - Errores de Alpine.js
                    </div>
                </div>
            </div>
        </div>

        <!-- Secci√≥n 5: Caracter√≠sticas -->
        <div class="demo-section">
            <h2 class="demo-title">5. Caracter√≠sticas del Manejador</h2>
            <p class="demo-description">
                Funcionalidades incluidas en el manejador de errores.
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                    <h3 class="font-semibold text-green-800 mb-2">‚úÖ Captura Autom√°tica</h3>
                    <p class="text-sm text-green-700">Captura todos los errores de JavaScript autom√°ticamente</p>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h3 class="font-semibold text-blue-800 mb-2">üé® Dise√±o Consistente</h3>
                    <p class="text-sm text-blue-700">Usa el mismo dise√±o que los componentes de error</p>
                </div>
                
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                    <h3 class="font-semibold text-yellow-800 mb-2">üì± Responsive</h3>
                    <p class="text-sm text-yellow-700">Se adapta a m√≥viles, tablets y desktop</p>
                </div>
                
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                    <h3 class="font-semibold text-purple-800 mb-2">üîß Personalizable</h3>
                    <p class="text-sm text-purple-700">Funciones globales para errores personalizados</p>
                </div>
                
                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <h3 class="font-semibold text-red-800 mb-2">üìä Detalles T√©cnicos</h3>
                    <p class="text-sm text-red-700">Muestra stack trace y detalles del error</p>
                </div>
                
                <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                    <h3 class="font-semibold text-indigo-800 mb-2">‚è∞ Auto-cierre</h3>
                    <p class="text-sm text-indigo-700">Se cierra autom√°ticamente despu√©s de 10 segundos</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Funciones para generar errores de prueba
        function generarErrorJS() {
            // Generar un error de JavaScript
            try {
                const objeto = null;
                objeto.propiedad.inexistente;
            } catch (error) {
                // El error ser√° capturado autom√°ticamente por el manejador
                throw error;
            }
        }

        function generarPromesaRechazada() {
            // Generar una promesa rechazada
            Promise.reject(new Error('Esta promesa fue rechazada intencionalmente'));
        }

        function generarErrorRecurso() {
            // Generar un error de recurso
            const img = new Image();
            img.src = 'imagen-inexistente.jpg';
            img.onerror = function() {
                // El error ser√° capturado autom√°ticamente
            };
        }

        // Funciones para errores personalizados
        function mostrarErrorPersonalizado() {
            window.mostrarErrorJS(
                'Error Personalizado',
                'Este es un error personalizado generado para la demostraci√≥n.',
                'error',
                'Detalles t√©cnicos del error:\n- Archivo: demo_javascript_errors.html\n- L√≠nea: 150\n- Funci√≥n: mostrarErrorPersonalizado()'
            );
        }

        function mostrarAdvertenciaPersonalizada() {
            window.mostrarAdvertencia('Esta es una advertencia personalizada. Ten cuidado con esta operaci√≥n.');
        }

        function mostrarInformacionPersonalizada() {
            window.mostrarInformacion('El sistema est√° funcionando correctamente. Esta es informaci√≥n importante.');
        }

        function mostrarExitoPersonalizado() {
            window.mostrarExito('¬°Operaci√≥n completada exitosamente! Los datos se han guardado correctamente.');
        }

        // Formulario de validaci√≥n
        document.addEventListener('alpine:init', () => {
            Alpine.data('formularioValidacion', () => ({
                numeroGuia: '',
                emailCliente: '',
                
                validarFormulario() {
                    // Limpiar errores anteriores
                    this.limpiarErrores();
                    
                    let hayErrores = false;
                    
                    // Validar n√∫mero de gu√≠a
                    if (!this.numeroGuia) {
                        window.mostrarErrorValidacion('El n√∫mero de gu√≠a es requerido');
                        hayErrores = true;
                    } else if (this.numeroGuia.length < 10) {
                        window.mostrarErrorValidacion('El n√∫mero de gu√≠a debe tener al menos 10 caracteres');
                        hayErrores = true;
                    }
                    
                    // Validar email
                    if (!this.emailCliente) {
                        window.mostrarErrorValidacion('El email del cliente es requerido');
                        hayErrores = true;
                    } else if (!this.validarEmail(this.emailCliente)) {
                        window.mostrarErrorValidacion('El email del cliente no tiene un formato v√°lido');
                        hayErrores = true;
                    }
                    
                    // Si no hay errores, mostrar √©xito
                    if (!hayErrores) {
                        window.mostrarExito('Formulario validado correctamente. Todos los campos son v√°lidos.');
                        this.numeroGuia = '';
                        this.emailCliente = '';
                    }
                },
                
                validarEmail(email) {
                    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    return regex.test(email);
                },
                
                limpiarErrores() {
                    // Esta funci√≥n se puede usar para limpiar errores anteriores
                    // En este caso, el manejador se encarga autom√°ticamente
                }
            }));
        });
    </script>
</body>
</html>
